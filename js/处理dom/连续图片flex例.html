<!doctype html>
<html lang="en">
  <head>
    <meta charset="UTF-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" />
    <title>Document</title>
  </head>
  <body>
    <div>
      <span>
        <p>
          <b>10.</b>
          掌握安全用电常识，是当代每个公民必备的素养.下列四个图中符合安全用电原则的是
        </p>
      </span>
      <p>
        <span class="image-box">
          <img
            class="c-question-img"
            src="http://book-stable.oss-cn-shanghai.aliyuncs.com/img/66792b7ee6c6f300091a1ad7/3a60008.jpg?x-oss-process=image%2Fformat%2Cwebp&amp;t=1735012644949"
            alt=""
            data-description="甲"
            data-tif-src="https://book-stable.oss-cn-shanghai.aliyuncs.com/img/66792b7ee6c6f300091a1ad7/3a60008.tif?x-oss-process=image/interlace,1/format,jpg"
            data-filename="3a60008.tif"
            data-image-tip="2848"
            img-id="111"
            data-image-uid="532203e72"
            style="
              vertical-align: middle;
              object-fit: contain;
              width: 103px;
              height: 80.324px;
              margin-top: 32px;
            "
          />
          <span><span data-image-tip="2848" class="image-desc">甲</span></span>
        </span>
        <span class="image-box">
          <img
            class="c-question-img"
            src="http://book-stable.oss-cn-shanghai.aliyuncs.com/img/66792b7ee6c6f300091a1ad7/3a60009.jpg?x-oss-process=image%2Fformat%2Cwebp&amp;t=1735012644949"
            alt=""
            data-description="乙"
            data-tif-src="https://book-stable.oss-cn-shanghai.aliyuncs.com/img/66792b7ee6c6f300091a1ad7/3a60009.tif?x-oss-process=image/interlace,1/format,jpg"
            data-filename="3a60009.tif"
            data-image-tip="8650"
            img-id="222"
            data-image-uid="9621fa672"
            style="
              vertical-align: middle;
              object-fit: contain;
              width: 126px;
              height: 83.465px;
              margin-top: 29px;
            "
          />
          <span><span data-image-tip="8650" class="image-desc">乙</span></span>
        </span>
        <span class="image-box">
          <img
            class="c-question-img"
            src="http://book-stable.oss-cn-shanghai.aliyuncs.com/img/66792b7ee6c6f300091a1ad7/3a60010.jpg?x-oss-process=image%2Fformat%2Cwebp&amp;t=1735012644949"
            data-tif-src="https://book-stable.oss-cn-shanghai.aliyuncs.com/img/66792b7ee6c6f300091a1ad7/3a60010.tif?x-oss-process=image/interlace,1/format,jpg"
            data-filename="3a60010.tif"
            alt=""
            data-description="丙"
            data-image-tip="4606"
            img-id="333"
            data-image-uid="aa08d9be4"
            style="
              vertical-align: middle;
              object-fit: contain;
              width: 129px;
              height: 60.4988px;
              margin-top: 52px;
            "
          />
          <span><span data-image-tip="4606" class="image-desc">丙</span></span>
        </span>
        <span class="image-box">
          <img
            class="c-question-img"
            src="https://xdoc-stable.oss-cn-shanghai.aliyuncs.com/open/cd56cd069b/image/tmp/9bf7ebe95ba6406a85c3.png?t=1735012644949&amp;x-oss-process=image%2Fformat%2Cwebp"
            alt=""
            data-description="丁"
            data-tif-src="undefined"
            data-filename="undefined"
            data-image-tip="319"
            img-id="444"
            data-image-uid="faa7fa8d9"
            style="
              vertical-align: middle;
              object-fit: contain;
              width: 119px;
              height: 111.936px;
              margin-top: 0px;
            "
          />
          <span><span data-image-tip="319" class="image-desc">丁</span></span>
        </span>
      </p>
    </div>
    <hr />
    <hr />
    <div class="small-q">
      <div>
        <div class="small-q-item">
          <!--    <span style="color: violet">{{ data.size }}</span>-->
          <!-- todo -->
          <div class="question">
            <!-- 题目的题号和题干 -->
            <!-- 题目的题号和题干 -->
            <div
              data-v-3db36302=""
              class="noandbody"
              data-node-id="a7431aa22d1942ad8f31befb1cbbe240"
            >
              <div data-v-3db36302="" class="flex-start" style="white-space: nowrap">
                <div data-v-3db36302="" class="content-box">
                  <div>
                    <div>
                      <div>
                        <div>
                          <span>
                            <p seg-point="seg">
                              <b>（1）</b>
                              如图1，设空白部分的宽为
                              <span class="katex">
                                <span class="katex-mathml">
                                  <math xmlns="http://www.w3.org/1998/Math/MathML">
                                    <semantics>
                                      <mrow><mi>x</mi></mrow>
                                      <annotation encoding="application/x-tex">x</annotation>
                                    </semantics>
                                  </math>
                                </span>
                                <span class="katex-html" aria-hidden="true">
                                  <span class="base">
                                    <span class="strut" style="height: 0.4306em"></span>
                                    <span class="mord mathnormal">x</span>
                                  </span>
                                </span>
                              </span>
                              ，则
                              <span class="katex">
                                <span class="katex-mathml">
                                  <math xmlns="http://www.w3.org/1998/Math/MathML">
                                    <semantics>
                                      <mrow>
                                        <msub>
                                          <mi>S</mi>
                                          <mtext>阴影</mtext>
                                        </msub>
                                        <mo>=</mo>
                                      </mrow>
                                      <annotation encoding="application/x-tex">
                                        S_{{\text{阴影}}}=
                                      </annotation>
                                    </semantics>
                                  </math>
                                </span>
                                <span class="katex-html" aria-hidden="true">
                                  <span class="base">
                                    <span
                                      class="strut"
                                      style="height: 0.8333em; vertical-align: -0.15em"
                                    ></span>
                                    <span class="mord">
                                      <span class="mord mathnormal" style="margin-right: 0.05764em">
                                        S
                                      </span>
                                      <span class="msupsub">
                                        <span class="vlist-t vlist-t2">
                                          <span class="vlist-r">
                                            <span class="vlist" style="height: 0.3283em">
                                              <span
                                                style="
                                                  top: -2.55em;
                                                  margin-left: -0.0576em;
                                                  margin-right: 0.05em;
                                                "
                                              >
                                                <span class="pstrut" style="height: 2.7em"></span>
                                                <span class="sizing reset-size6 size3 mtight">
                                                  <span class="mord mtight">
                                                    <span class="mord mtight">
                                                      <span class="mord text mtight">
                                                        <span class="mord cjk_fallback mtight">
                                                          阴影
                                                        </span>
                                                      </span>
                                                    </span>
                                                  </span>
                                                </span>
                                              </span>
                                            </span>
                                            <span class="vlist-s">​</span>
                                          </span>
                                          <span class="vlist-r">
                                            <span class="vlist" style="height: 0.15em">
                                              <span></span>
                                            </span>
                                          </span>
                                        </span>
                                      </span>
                                    </span>
                                    <span class="mspace" style="margin-right: 0.2778em"></span>
                                    <span class="mrel">=</span>
                                  </span>
                                </span>
                              </span>
                              ④
                              <span data-blank-length="4" data-label="blank"></span>
                              ；
                            </p>
                          </span>
                          <p class="align-center">
                            <span class="image-box">
                              <img
                                class="c-question-img"
                                src="https://xdoc-stable.oss-cn-shanghai.aliyuncs.com/open/debug_cd56cd069b/image/15452550/JT19.tif.convert.jpg?x-oss-process=image%2Fformat%2Cwebp&amp;t=1735012222856"
                                data-description="图1"
                                data-tif-src="https://xdoc-stable.oss-cn-shanghai.aliyuncs.com/open/debug_cd56cd069b/image/15452550/JT19.tif?x-oss-process=image/interlace,1/format,jpg"
                                style="
                                  vertical-align: middle;
                                  object-fit: contain;
                                  width: 124px;
                                  height: 88px;
                                  margin-top: 0px;
                                "
                              />
                              <span><span class="image-desc">图1</span></span>
                            </span>
                          </p>
                        </div>
                      </div>
                    </div>
                  </div>
                </div>
                <!--v-if-->
              </div>
            </div>
            <!-- 不同题目的差异部分 -->
            <!-- 题目的答案和解析 -->
            <div data-v-8c6f6916="" class="clearfix ana-ans">
              <span>
                <div class="answer">
                  <span class="text">
                    <span style="color: var(--main1-6) !important; font-weight: 400">【答案】</span>
                    <span class="katex">
                      <span class="katex-mathml">
                        <math xmlns="http://www.w3.org/1998/Math/MathML">
                          <semantics>
                            <mrow>
                              <mo stretchy="false">(</mo>
                              <mi>a</mi>
                              <mo>−</mo>
                              <mn>2</mn>
                              <mi>x</mi>
                              <mo stretchy="false">)</mo>
                              <mo stretchy="false">(</mo>
                              <mi>b</mi>
                              <mo>−</mo>
                              <mn>2</mn>
                              <mi>x</mi>
                              <mo stretchy="false">)</mo>
                            </mrow>
                            <annotation encoding="application/x-tex">(a-2x)(b-2x)</annotation>
                          </semantics>
                        </math>
                      </span>
                      <span class="katex-html" aria-hidden="true">
                        <span class="base">
                          <span class="strut" style="height: 1em; vertical-align: -0.25em"></span>
                          <span class="mopen">(</span>
                          <span class="mord mathnormal">a</span>
                          <span class="mspace" style="margin-right: 0.2222em"></span>
                          <span class="mbin">−</span>
                          <span class="mspace" style="margin-right: 0.2222em"></span>
                        </span>
                        <span class="base">
                          <span class="strut" style="height: 1em; vertical-align: -0.25em"></span>
                          <span class="mord">2</span>
                          <span class="mord mathnormal">x</span>
                          <span class="mclose">)</span>
                          <span class="mopen">(</span>
                          <span class="mord mathnormal">b</span>
                          <span class="mspace" style="margin-right: 0.2222em"></span>
                          <span class="mbin">−</span>
                          <span class="mspace" style="margin-right: 0.2222em"></span>
                        </span>
                        <span class="base">
                          <span class="strut" style="height: 1em; vertical-align: -0.25em"></span>
                          <span class="mord">2</span>
                          <span class="mord mathnormal">x</span>
                          <span class="mclose">)</span>
                        </span>
                      </span>
                    </span>
                  </span>
                </div>
              </span>
              <span><div class="space-box"></div></span>
              <span><div class="end-box"></div></span>
            </div>
          </div>
          <!-- 标签 -->
          <div data-v-a8916c21="">
            <!-- 标签 -->
            <div data-v-a8916c21="" class="tags flex a-center" style="display: none"></div>
          </div>
        </div>
      </div>
      <div>
        <div class="small-q-item">
          <!--    <span style="color: violet">{{ data.size }}</span>-->
          <!-- todo -->
          <div class="question">
            <!-- 题目的题号和题干 -->
            <!-- 题目的题号和题干 -->
            <div
              data-v-3db36302=""
              class="noandbody"
              data-node-id="9ed5d800932a4cc5a392aeaad60ce996"
            >
              <div data-v-3db36302="" class="flex-start" style="white-space: nowrap">
                <div data-v-3db36302="" class="content-box">
                  <div>
                    <div>
                      <div>
                        <div>
                          <span>
                            <p seg-point="seg">
                              <b>（2）</b>
                              如图2、图3、图4，设阴影道路的宽为
                              <span class="katex">
                                <span class="katex-mathml">
                                  <math xmlns="http://www.w3.org/1998/Math/MathML">
                                    <semantics>
                                      <mrow><mi>x</mi></mrow>
                                      <annotation encoding="application/x-tex">x</annotation>
                                    </semantics>
                                  </math>
                                </span>
                                <span class="katex-html" aria-hidden="true">
                                  <span class="base">
                                    <span class="strut" style="height: 0.4306em"></span>
                                    <span class="mord mathnormal">x</span>
                                  </span>
                                </span>
                              </span>
                              ，则
                              <span class="katex">
                                <span class="katex-mathml">
                                  <math xmlns="http://www.w3.org/1998/Math/MathML">
                                    <semantics>
                                      <mrow>
                                        <msub>
                                          <mi>S</mi>
                                          <mtext>空白</mtext>
                                        </msub>
                                        <mo>=</mo>
                                      </mrow>
                                      <annotation encoding="application/x-tex">
                                        S_{{\text{空白}}}=
                                      </annotation>
                                    </semantics>
                                  </math>
                                </span>
                                <span class="katex-html" aria-hidden="true">
                                  <span class="base">
                                    <span
                                      class="strut"
                                      style="height: 0.8333em; vertical-align: -0.15em"
                                    ></span>
                                    <span class="mord">
                                      <span class="mord mathnormal" style="margin-right: 0.05764em">
                                        S
                                      </span>
                                      <span class="msupsub">
                                        <span class="vlist-t vlist-t2">
                                          <span class="vlist-r">
                                            <span class="vlist" style="height: 0.3283em">
                                              <span
                                                style="
                                                  top: -2.55em;
                                                  margin-left: -0.0576em;
                                                  margin-right: 0.05em;
                                                "
                                              >
                                                <span class="pstrut" style="height: 2.7em"></span>
                                                <span class="sizing reset-size6 size3 mtight">
                                                  <span class="mord mtight">
                                                    <span class="mord mtight">
                                                      <span class="mord text mtight">
                                                        <span class="mord cjk_fallback mtight">
                                                          空白
                                                        </span>
                                                      </span>
                                                    </span>
                                                  </span>
                                                </span>
                                              </span>
                                            </span>
                                            <span class="vlist-s">​</span>
                                          </span>
                                          <span class="vlist-r">
                                            <span class="vlist" style="height: 0.15em">
                                              <span></span>
                                            </span>
                                          </span>
                                        </span>
                                      </span>
                                    </span>
                                    <span class="mspace" style="margin-right: 0.2778em"></span>
                                    <span class="mrel">=</span>
                                  </span>
                                </span>
                              </span>
                              ⑤
                              <span data-blank-length="4" data-label="blank"></span>
                              ；
                            </p>
                          </span>
                          <p class="align-center">
                            <span class="image-box">
                              <img
                                class="c-question-img"
                                src="https://xdoc-stable.oss-cn-shanghai.aliyuncs.com/open/debug_cd56cd069b/image/15452550/JT20.tif.convert.jpg?x-oss-process=image%2Fformat%2Cwebp&amp;t=1735012222858"
                                data-description="图2"
                                data-tif-src="https://xdoc-stable.oss-cn-shanghai.aliyuncs.com/open/debug_cd56cd069b/image/15452550/JT20.tif?x-oss-process=image/interlace,1/format,jpg"
                                style="
                                  vertical-align: middle;
                                  object-fit: contain;
                                  width: 134px;
                                  height: 83px;
                                  margin-top: 0px;
                                "
                              />
                              <span><span class="image-desc">图2</span></span>
                            </span>
                          </p>
                          <p class="align-center">
                            <span class="image-box">
                              <img
                                class="c-question-img"
                                src="https://xdoc-stable.oss-cn-shanghai.aliyuncs.com/open/debug_cd56cd069b/image/15452550/JT21.tif.convert.jpg?x-oss-process=image%2Fformat%2Cwebp&amp;t=1735012222858"
                                data-description="图3"
                                data-tif-src="https://xdoc-stable.oss-cn-shanghai.aliyuncs.com/open/debug_cd56cd069b/image/15452550/JT21.tif?x-oss-process=image/interlace,1/format,jpg"
                                style="
                                  vertical-align: middle;
                                  object-fit: contain;
                                  width: 133px;
                                  height: 83px;
                                  margin-top: 0px;
                                "
                              />
                              <span><span class="image-desc">图3</span></span>
                            </span>
                          </p>
                          <p class="align-center">
                            <span class="image-box">
                              <img
                                class="c-question-img"
                                src="https://xdoc-stable.oss-cn-shanghai.aliyuncs.com/open/debug_cd56cd069b/image/15452550/JT22.tif.convert.jpg?x-oss-process=image%2Fformat%2Cwebp&amp;t=1735012222858"
                                data-description="图4"
                                data-tif-src="https://xdoc-stable.oss-cn-shanghai.aliyuncs.com/open/debug_cd56cd069b/image/15452550/JT22.tif?x-oss-process=image/interlace,1/format,jpg"
                                style="
                                  vertical-align: middle;
                                  object-fit: contain;
                                  width: 133px;
                                  height: 83px;
                                  margin-top: 0px;
                                "
                              />
                              <span><span class="image-desc">图4</span></span>
                            </span>
                          </p>
                        </div>
                      </div>
                    </div>
                  </div>
                </div>
                <!--v-if-->
              </div>
            </div>
            <!-- 不同题目的差异部分 -->
            <!-- 题目的答案和解析 -->
            <div data-v-8c6f6916="" class="clearfix ana-ans">
              <span>
                <div class="answer">
                  <span class="text">
                    <span style="color: var(--main1-6) !important; font-weight: 400">【答案】</span>
                    <span class="katex">
                      <span class="katex-mathml">
                        <math xmlns="http://www.w3.org/1998/Math/MathML">
                          <semantics>
                            <mrow>
                              <mo stretchy="false">(</mo>
                              <mi>a</mi>
                              <mo>−</mo>
                              <mi>x</mi>
                              <mo stretchy="false">)</mo>
                              <mo stretchy="false">(</mo>
                              <mi>b</mi>
                              <mo>−</mo>
                              <mi>x</mi>
                              <mo stretchy="false">)</mo>
                            </mrow>
                            <annotation encoding="application/x-tex">(a-x)(b-x)</annotation>
                          </semantics>
                        </math>
                      </span>
                      <span class="katex-html" aria-hidden="true">
                        <span class="base">
                          <span class="strut" style="height: 1em; vertical-align: -0.25em"></span>
                          <span class="mopen">(</span>
                          <span class="mord mathnormal">a</span>
                          <span class="mspace" style="margin-right: 0.2222em"></span>
                          <span class="mbin">−</span>
                          <span class="mspace" style="margin-right: 0.2222em"></span>
                        </span>
                        <span class="base">
                          <span class="strut" style="height: 1em; vertical-align: -0.25em"></span>
                          <span class="mord mathnormal">x</span>
                          <span class="mclose">)</span>
                          <span class="mopen">(</span>
                          <span class="mord mathnormal">b</span>
                          <span class="mspace" style="margin-right: 0.2222em"></span>
                          <span class="mbin">−</span>
                          <span class="mspace" style="margin-right: 0.2222em"></span>
                        </span>
                        <span class="base">
                          <span class="strut" style="height: 1em; vertical-align: -0.25em"></span>
                          <span class="mord mathnormal">x</span>
                          <span class="mclose">)</span>
                        </span>
                      </span>
                    </span>
                  </span>
                </div>
              </span>
              <span><div class="space-box"></div></span>
              <span><div class="end-box"></div></span>
            </div>
          </div>
          <!-- 标签 -->
          <div data-v-a8916c21="">
            <!-- 标签 -->
            <div data-v-a8916c21="" class="tags flex a-center" style="display: none"></div>
          </div>
        </div>
      </div>
      <div>
        <div class="small-q-item">
          <!--    <span style="color: violet">{{ data.size }}</span>-->
          <!-- todo -->
          <div class="question">
            <!-- 题目的题号和题干 -->
            <!-- 题目的题号和题干 -->
            <div
              data-v-3db36302=""
              class="noandbody"
              data-node-id="9289f446f9514c528067820a82eb2567"
            >
              <div data-v-3db36302="" class="flex-start" style="white-space: nowrap">
                <div data-v-3db36302="" class="content-box">
                  <div>
                    <div>
                      <div>
                        <div>
                          <span>
                            <p seg-point="seg">
                              <b>（3）</b>
                              如图5，用总长为
                              <span class="katex">
                                <span class="katex-mathml">
                                  <math xmlns="http://www.w3.org/1998/Math/MathML">
                                    <semantics>
                                      <mrow><mi>m</mi></mrow>
                                      <annotation encoding="application/x-tex">m</annotation>
                                    </semantics>
                                  </math>
                                </span>
                                <span class="katex-html" aria-hidden="true">
                                  <span class="base">
                                    <span class="strut" style="height: 0.4306em"></span>
                                    <span class="mord mathnormal">m</span>
                                  </span>
                                </span>
                              </span>
                              米的篱笆，围成一个矩形，一边靠墙，若平行于墙的一边长为
                              <span class="katex">
                                <span class="katex-mathml">
                                  <math xmlns="http://www.w3.org/1998/Math/MathML">
                                    <semantics>
                                      <mrow><mi>x</mi></mrow>
                                      <annotation encoding="application/x-tex">x</annotation>
                                    </semantics>
                                  </math>
                                </span>
                                <span class="katex-html" aria-hidden="true">
                                  <span class="base">
                                    <span class="strut" style="height: 0.4306em"></span>
                                    <span class="mord mathnormal">x</span>
                                  </span>
                                </span>
                              </span>
                              米（
                              <span data-label="font" style="font-family: 楷体">墙面长度大于</span>
                              <span class="katex">
                                <span class="katex-mathml">
                                  <math xmlns="http://www.w3.org/1998/Math/MathML">
                                    <semantics>
                                      <mrow><mi>x</mi></mrow>
                                      <annotation encoding="application/x-tex">x</annotation>
                                    </semantics>
                                  </math>
                                </span>
                                <span class="katex-html" aria-hidden="true">
                                  <span class="base">
                                    <span class="strut" style="height: 0.4306em"></span>
                                    <span class="mord mathnormal">x</span>
                                  </span>
                                </span>
                              </span>
                              <span data-label="font" style="font-family: 楷体">米</span>
                              ），则所围成矩形的面积为
                              <span class="katex">
                                <span class="katex-mathml">
                                  <math xmlns="http://www.w3.org/1998/Math/MathML">
                                    <semantics>
                                      <mrow>
                                        <mi>S</mi>
                                        <mo>=</mo>
                                      </mrow>
                                      <annotation encoding="application/x-tex">S=</annotation>
                                    </semantics>
                                  </math>
                                </span>
                                <span class="katex-html" aria-hidden="true">
                                  <span class="base">
                                    <span class="strut" style="height: 0.6833em"></span>
                                    <span class="mord mathnormal" style="margin-right: 0.05764em">
                                      S
                                    </span>
                                    <span class="mspace" style="margin-right: 0.2778em"></span>
                                    <span class="mrel">=</span>
                                  </span>
                                </span>
                              </span>
                              ⑥
                              <span data-label="blank" data-blank-length="2"></span>
                              ；如图6，当在边上留1米的门时，
                              <span class="katex">
                                <span class="katex-mathml">
                                  <math xmlns="http://www.w3.org/1998/Math/MathML">
                                    <semantics>
                                      <mrow>
                                        <mi>S</mi>
                                        <mo>=</mo>
                                      </mrow>
                                      <annotation encoding="application/x-tex">S=</annotation>
                                    </semantics>
                                  </math>
                                </span>
                                <span class="katex-html" aria-hidden="true">
                                  <span class="base">
                                    <span class="strut" style="height: 0.6833em"></span>
                                    <span class="mord mathnormal" style="margin-right: 0.05764em">
                                      S
                                    </span>
                                    <span class="mspace" style="margin-right: 0.2778em"></span>
                                    <span class="mrel">=</span>
                                  </span>
                                </span>
                              </span>
                              ⑦
                              <span data-label="blank" data-blank-length="2"></span>
                              ；
                            </p>
                          </span>
                          <p class="align-center">
                            <span class="image-box">
                              <img
                                class="c-question-img"
                                src="https://xdoc-stable.oss-cn-shanghai.aliyuncs.com/open/debug_cd56cd069b/image/15452550/JT23.tif.convert.jpg?x-oss-process=image%2Fformat%2Cwebp&amp;t=1735012222861"
                                data-description="图5"
                                data-tif-src="https://xdoc-stable.oss-cn-shanghai.aliyuncs.com/open/debug_cd56cd069b/image/15452550/JT23.tif?x-oss-process=image/interlace,1/format,jpg"
                                style="
                                  vertical-align: middle;
                                  object-fit: contain;
                                  width: 116px;
                                  height: 63px;
                                  margin-top: 0px;
                                "
                              />
                              <span><span class="image-desc">图5</span></span>
                            </span>
                          </p>
                          <p class="align-center">
                            <span class="image-box">
                              <img
                                class="c-question-img"
                                src="https://xdoc-stable.oss-cn-shanghai.aliyuncs.com/open/debug_cd56cd069b/image/15452550/JT24.tif.convert.jpg?x-oss-process=image%2Fformat%2Cwebp&amp;t=1735012222861"
                                data-description="图6"
                                data-tif-src="https://xdoc-stable.oss-cn-shanghai.aliyuncs.com/open/debug_cd56cd069b/image/15452550/JT24.tif?x-oss-process=image/interlace,1/format,jpg"
                                style="
                                  vertical-align: middle;
                                  object-fit: contain;
                                  width: 128px;
                                  height: 73px;
                                  margin-top: 0px;
                                "
                              />
                              <span><span class="image-desc">图6</span></span>
                            </span>
                          </p>
                        </div>
                      </div>
                    </div>
                  </div>
                </div>
                <!--v-if-->
              </div>
            </div>
            <!-- 不同题目的差异部分 -->
            <!-- 题目的答案和解析 -->
            <div data-v-8c6f6916="" class="clearfix ana-ans">
              <span>
                <div class="answer">
                  <span class="text">
                    <span style="color: var(--main1-6) !important; font-weight: 400">【答案】</span>
                    <span class="katex">
                      <span class="katex-mathml">
                        <math xmlns="http://www.w3.org/1998/Math/MathML">
                          <semantics>
                            <mrow>
                              <mi>x</mi>
                              <mo>⋅</mo>
                              <mfrac>
                                <mrow>
                                  <mi>m</mi>
                                  <mo>−</mo>
                                  <mi>x</mi>
                                </mrow>
                                <mn>2</mn>
                              </mfrac>
                            </mrow>
                            <annotation encoding="application/x-tex">
                              x\cdot \frac{m-x}{2}
                            </annotation>
                          </semantics>
                        </math>
                      </span>
                      <span class="katex-html" aria-hidden="true">
                        <span class="base">
                          <span class="strut" style="height: 0.4445em"></span>
                          <span class="mord mathnormal">x</span>
                          <span class="mspace" style="margin-right: 0.2222em"></span>
                          <span class="mbin">⋅</span>
                          <span class="mspace" style="margin-right: 0.2222em"></span>
                        </span>
                        <span class="base">
                          <span
                            class="strut"
                            style="height: 1.1473em; vertical-align: -0.345em"
                          ></span>
                          <span class="mord">
                            <span class="mopen nulldelimiter"></span>
                            <span class="mfrac">
                              <span class="vlist-t vlist-t2">
                                <span class="vlist-r">
                                  <span class="vlist" style="height: 0.8023em">
                                    <span style="top: -2.655em">
                                      <span class="pstrut" style="height: 3em"></span>
                                      <span class="sizing reset-size6 size3 mtight">
                                        <span class="mord mtight">
                                          <span class="mord mtight">2</span>
                                        </span>
                                      </span>
                                    </span>
                                    <span style="top: -3.23em">
                                      <span class="pstrut" style="height: 3em"></span>
                                      <span
                                        class="frac-line"
                                        style="border-bottom-width: 0.04em"
                                      ></span>
                                    </span>
                                    <span style="top: -3.394em">
                                      <span class="pstrut" style="height: 3em"></span>
                                      <span class="sizing reset-size6 size3 mtight">
                                        <span class="mord mtight">
                                          <span class="mord mathnormal mtight">m</span>
                                          <span class="mbin mtight">−</span>
                                          <span class="mord mathnormal mtight">x</span>
                                        </span>
                                      </span>
                                    </span>
                                  </span>
                                  <span class="vlist-s">​</span>
                                </span>
                                <span class="vlist-r">
                                  <span class="vlist" style="height: 0.345em"><span></span></span>
                                </span>
                              </span>
                            </span>
                            <span class="mclose nulldelimiter"></span>
                          </span>
                        </span>
                      </span>
                    </span>
                  </span>
                  &nbsp;&nbsp;&nbsp;
                  <span class="text">
                    <span class="katex">
                      <span class="katex-mathml">
                        <math xmlns="http://www.w3.org/1998/Math/MathML">
                          <semantics>
                            <mrow>
                              <mi>x</mi>
                              <mo>⋅</mo>
                              <mfrac>
                                <mrow>
                                  <mi>m</mi>
                                  <mo>+</mo>
                                  <mn>1</mn>
                                  <mo>−</mo>
                                  <mi>x</mi>
                                </mrow>
                                <mn>2</mn>
                              </mfrac>
                            </mrow>
                            <annotation encoding="application/x-tex">
                              x\cdot \frac{m+1-x}{2}
                            </annotation>
                          </semantics>
                        </math>
                      </span>
                      <span class="katex-html" aria-hidden="true">
                        <span class="base">
                          <span class="strut" style="height: 0.4445em"></span>
                          <span class="mord mathnormal">x</span>
                          <span class="mspace" style="margin-right: 0.2222em"></span>
                          <span class="mbin">⋅</span>
                          <span class="mspace" style="margin-right: 0.2222em"></span>
                        </span>
                        <span class="base">
                          <span
                            class="strut"
                            style="height: 1.1901em; vertical-align: -0.345em"
                          ></span>
                          <span class="mord">
                            <span class="mopen nulldelimiter"></span>
                            <span class="mfrac">
                              <span class="vlist-t vlist-t2">
                                <span class="vlist-r">
                                  <span class="vlist" style="height: 0.8451em">
                                    <span style="top: -2.655em">
                                      <span class="pstrut" style="height: 3em"></span>
                                      <span class="sizing reset-size6 size3 mtight">
                                        <span class="mord mtight">
                                          <span class="mord mtight">2</span>
                                        </span>
                                      </span>
                                    </span>
                                    <span style="top: -3.23em">
                                      <span class="pstrut" style="height: 3em"></span>
                                      <span
                                        class="frac-line"
                                        style="border-bottom-width: 0.04em"
                                      ></span>
                                    </span>
                                    <span style="top: -3.394em">
                                      <span class="pstrut" style="height: 3em"></span>
                                      <span class="sizing reset-size6 size3 mtight">
                                        <span class="mord mtight">
                                          <span class="mord mathnormal mtight">m</span>
                                          <span class="mbin mtight">+</span>
                                          <span class="mord mtight">1</span>
                                          <span class="mbin mtight">−</span>
                                          <span class="mord mathnormal mtight">x</span>
                                        </span>
                                      </span>
                                    </span>
                                  </span>
                                  <span class="vlist-s">​</span>
                                </span>
                                <span class="vlist-r">
                                  <span class="vlist" style="height: 0.345em"><span></span></span>
                                </span>
                              </span>
                            </span>
                            <span class="mclose nulldelimiter"></span>
                          </span>
                        </span>
                      </span>
                    </span>
                  </span>
                </div>
              </span>
              <span><div class="space-box"></div></span>
              <span><div class="end-box"></div></span>
            </div>
          </div>
          <!-- 标签 -->
          <div data-v-a8916c21="">
            <!-- 标签 -->
            <div data-v-a8916c21="" class="tags flex a-center" style="display: none"></div>
          </div>
        </div>
      </div>
      <div>
        <div class="small-q-item">
          <!--    <span style="color: violet">{{ data.size }}</span>-->
          <!-- todo -->
          <div class="question">
            <!-- 题目的题号和题干 -->
            <!-- 题目的题号和题干 -->
            <div
              data-v-3db36302=""
              class="noandbody"
              data-node-id="13b6aa6238cb486aa25ac974a4822314"
            >
              <div data-v-3db36302="" class="flex-start" style="white-space: nowrap">
                <div data-v-3db36302="" class="content-box">
                  <div>
                    <div>
                      <div>
                        <div>
                          <span>
                            <p seg-point="seg">
                              <b>（4）</b>
                              如图7，长为
                              <span class="katex">
                                <span class="katex-mathml">
                                  <math xmlns="http://www.w3.org/1998/Math/MathML">
                                    <semantics>
                                      <mrow><mi>a</mi></mrow>
                                      <annotation encoding="application/x-tex">a</annotation>
                                    </semantics>
                                  </math>
                                </span>
                                <span class="katex-html" aria-hidden="true">
                                  <span class="base">
                                    <span class="strut" style="height: 0.4306em"></span>
                                    <span class="mord mathnormal">a</span>
                                  </span>
                                </span>
                              </span>
                              ，宽为
                              <span class="katex">
                                <span class="katex-mathml">
                                  <math xmlns="http://www.w3.org/1998/Math/MathML">
                                    <semantics>
                                      <mrow><mi>b</mi></mrow>
                                      <annotation encoding="application/x-tex">b</annotation>
                                    </semantics>
                                  </math>
                                </span>
                                <span class="katex-html" aria-hidden="true">
                                  <span class="base">
                                    <span class="strut" style="height: 0.6944em"></span>
                                    <span class="mord mathnormal">b</span>
                                  </span>
                                </span>
                              </span>
                              的矩形
                              <span class="katex">
                                <span class="katex-mathml">
                                  <math xmlns="http://www.w3.org/1998/Math/MathML">
                                    <semantics>
                                      <mrow>
                                        <mi>A</mi>
                                        <mi>B</mi>
                                        <mi>C</mi>
                                        <mi>D</mi>
                                      </mrow>
                                      <annotation encoding="application/x-tex">ABCD</annotation>
                                    </semantics>
                                  </math>
                                </span>
                                <span class="katex-html" aria-hidden="true">
                                  <span class="base">
                                    <span class="strut" style="height: 0.6833em"></span>
                                    <span class="mord mathnormal">A</span>
                                    <span class="mord mathnormal" style="margin-right: 0.07153em">
                                      BC
                                    </span>
                                    <span class="mord mathnormal" style="margin-right: 0.02778em">
                                      D
                                    </span>
                                  </span>
                                </span>
                              </span>
                              的四个角都剪去一个边长为
                              <span class="katex">
                                <span class="katex-mathml">
                                  <math xmlns="http://www.w3.org/1998/Math/MathML">
                                    <semantics>
                                      <mrow><mi>x</mi></mrow>
                                      <annotation encoding="application/x-tex">x</annotation>
                                    </semantics>
                                  </math>
                                </span>
                                <span class="katex-html" aria-hidden="true">
                                  <span class="base">
                                    <span class="strut" style="height: 0.4306em"></span>
                                    <span class="mord mathnormal">x</span>
                                  </span>
                                </span>
                              </span>
                              的正方形后做成一个无盖的盒子，则该盒子的底面积
                              <span class="katex">
                                <span class="katex-mathml">
                                  <math xmlns="http://www.w3.org/1998/Math/MathML">
                                    <semantics>
                                      <mrow>
                                        <mi>S</mi>
                                        <mo>=</mo>
                                      </mrow>
                                      <annotation encoding="application/x-tex">S=</annotation>
                                    </semantics>
                                  </math>
                                </span>
                                <span class="katex-html" aria-hidden="true">
                                  <span class="base">
                                    <span class="strut" style="height: 0.6833em"></span>
                                    <span class="mord mathnormal" style="margin-right: 0.05764em">
                                      S
                                    </span>
                                    <span class="mspace" style="margin-right: 0.2778em"></span>
                                    <span class="mrel">=</span>
                                  </span>
                                </span>
                              </span>
                              ⑧
                              <span data-blank-length="4" data-label="blank"></span>
                              .
                            </p>
                          </span>
                          <p>
                            <span class="image-box">
                              <img
                                class="c-question-img"
                                src="https://xdoc-stable.oss-cn-shanghai.aliyuncs.com/open/debug_cd56cd069b/image/15452550/JT25.tif.convert.jpg?x-oss-process=image%2Fformat%2Cwebp&amp;t=1735012222863"
                                data-description="图7"
                                data-tif-src="https://xdoc-stable.oss-cn-shanghai.aliyuncs.com/open/debug_cd56cd069b/image/15452550/JT25.tif?x-oss-process=image/interlace,1/format,jpg"
                                style="
                                  vertical-align: middle;
                                  object-fit: contain;
                                  width: 120px;
                                  height: 84px;
                                  margin-top: 0px;
                                "
                              />
                              <span><span class="image-desc">图7</span></span>
                            </span>
                          </p>
                        </div>
                      </div>
                    </div>
                  </div>
                </div>
                <!--v-if-->
              </div>
            </div>
            <!-- 不同题目的差异部分 -->
            <!-- 题目的答案和解析 -->
            <div data-v-8c6f6916="" class="clearfix ana-ans">
              <span>
                <div class="answer">
                  <span class="text">
                    <span style="color: var(--main1-6) !important; font-weight: 400">【答案】</span>
                    <span class="katex">
                      <span class="katex-mathml">
                        <math xmlns="http://www.w3.org/1998/Math/MathML">
                          <semantics>
                            <mrow>
                              <mo stretchy="false">(</mo>
                              <mi>a</mi>
                              <mo>−</mo>
                              <mn>2</mn>
                              <mi>x</mi>
                              <mo stretchy="false">)</mo>
                              <mo stretchy="false">(</mo>
                              <mi>b</mi>
                              <mo>−</mo>
                              <mn>2</mn>
                              <mi>x</mi>
                              <mo stretchy="false">)</mo>
                            </mrow>
                            <annotation encoding="application/x-tex">(a-2x)(b-2x)</annotation>
                          </semantics>
                        </math>
                      </span>
                      <span class="katex-html" aria-hidden="true">
                        <span class="base">
                          <span class="strut" style="height: 1em; vertical-align: -0.25em"></span>
                          <span class="mopen">(</span>
                          <span class="mord mathnormal">a</span>
                          <span class="mspace" style="margin-right: 0.2222em"></span>
                          <span class="mbin">−</span>
                          <span class="mspace" style="margin-right: 0.2222em"></span>
                        </span>
                        <span class="base">
                          <span class="strut" style="height: 1em; vertical-align: -0.25em"></span>
                          <span class="mord">2</span>
                          <span class="mord mathnormal">x</span>
                          <span class="mclose">)</span>
                          <span class="mopen">(</span>
                          <span class="mord mathnormal">b</span>
                          <span class="mspace" style="margin-right: 0.2222em"></span>
                          <span class="mbin">−</span>
                          <span class="mspace" style="margin-right: 0.2222em"></span>
                        </span>
                        <span class="base">
                          <span class="strut" style="height: 1em; vertical-align: -0.25em"></span>
                          <span class="mord">2</span>
                          <span class="mord mathnormal">x</span>
                          <span class="mclose">)</span>
                        </span>
                      </span>
                    </span>
                  </span>
                </div>
              </span>
              <span><div class="space-box"></div></span>
              <span><div class="end-box"></div></span>
            </div>
          </div>
          <!-- 标签 -->
          <div data-v-a8916c21="">
            <!-- 标签 -->
            <div data-v-a8916c21="" class="tags flex a-center" style="display: none"></div>
          </div>
        </div>
      </div>
      <div class="question"><!--v-if--></div>
    </div>
    <hr />
    <hr />
  </body>

  <script>
    // 遍历树
    function* iterateNode(nodes, options = {}) {
      const {
        level = 0,
        parent,
        order = 'pre',
        path = false,
        back = false,
        getChildren = (n) => n.children
      } = options;
      const siblings = Array.prototype.slice.call(nodes, 0);
      if (back) siblings.reverse();
      let index = 0;
      for (const node of siblings) {
        const subPath = path
          ? Array.isArray(path)
            ? /** @type Array */ path.concat([node])
            : [node]
          : false;
        let stop = false;
        if (order === 'pre') {
          // 先序 dfs
          const stopIterateChildren = () => {
            // 停止遍历（当前节点的）子节点
            stop = true;
          };
          yield {
            node,
            index,
            parent,
            path: subPath || undefined,
            siblings,
            level,
            stopIterateChildren
          };
        }
        if (!stop) {
          // 递归遍历子节点
          const subs = getChildren(node);
          if (subs && subs.length) {
            yield* iterateNode(subs, {
              level: level + 1,
              parent: node,
              path: subPath,
              order,
              back,
              getChildren
            });
          }
        }
        if (order === 'post') {
          // 后序 dfs
          yield { node, index, parent, path: subPath || undefined, siblings, level };
        }
        index++;
      }
    }

    // 判断图片是否是块级图片
    function isBlockImage(node) {
      // - 有序号的图片认为是行内
      if (
        node.previousElementSibling &&
        node.previousElementSibling.tagName === 'SPAN' &&
        !node.previousElementSibling.dataset.imageTip &&
        /\d.\s*/.test(node.previousElementSibling.innerText)
      ) {
        return false;
      }
      // - 答案的图片认为是行内
      if (findParentNode(node, (n) => n.dataset?._label === 'answer-block')) {
        return false;
      }
      // - 有图说容器的图片认为是行内
      if (node.parentElement?.classList.contains('image-tip-container')) {
        return false;
      }
      // - 有图说的图片认为是块级
      if (node.dataset?.imageTip) {
        return true;
      }
      // - 该节点没有兄弟节点
      // - 该节点的祖先节点是行内元素，但是祖先节点存在兄弟节点，并且兄弟节点是块级元素
      if (
        ((!node.nextElementSibling && !node.nextSibling) ||
          node.nextElementSibling?.nodeName === 'BR') &&
        ((!node.previousElementSibling && !node.previousSibling) ||
          node.previousElementSibling?.nodeName === 'BR')
      ) {
        // element、textNode
        let targetNode = node.parentElement;
        let curNode = node;
        if (!targetNode) {
          return true;
        }
        const blockTags = ['SECTION', 'P', 'TD'];
        while (
          // 行内元素、子节点的个数是 1
          targetNode &&
          !blockTags.includes(targetNode.tagName) &&
          getComputedStyle(targetNode)?.display?.includes('inline') &&
          targetNode.childNodes.length === 1
        ) {
          curNode = targetNode;
          targetNode = targetNode.parentElement;
        }
        targetNode = curNode;
        if (
          targetNode.nextElementSibling &&
          targetNode.nextSibling === targetNode.nextElementSibling
        ) {
          // 祖先节点不是块级元素，但它的兄弟节点是块级元素
          const display = getComputedStyle(targetNode.nextElementSibling)?.display;
          if (display && !display.includes('inline')) {
            return true;
          }
        }
        if (
          targetNode.previousElementSibling &&
          targetNode.previousSibling === targetNode.previousElementSibling
        ) {
          const display = getComputedStyle(targetNode.previousElementSibling)?.display;
          if (display && !display.includes('inline')) {
            return true;
          }
        }
        if (
          ((!targetNode.nextElementSibling && !targetNode.nextSibling) ||
            targetNode.nextElementSibling?.nodeName === 'BR') &&
          ((!targetNode.previousElementSibling && !targetNode.previousSibling) ||
            targetNode.previousElementSibling?.nodeName === 'BR')
        ) {
          // 没有兄弟节点、兄弟节点是 BR
          return true;
        }
        return false;
      }
      const is_display_not_inline_and_float_none = (node) => {
        const style = window.getComputedStyle(node);
        return !style.display.includes('inline') && style.float === 'none';
      };
      const is_section_with_prop = (node) => {
        return node.parentElement?.tagName === 'SECTION' && node.parentElement.dataset?.prop;
      };
      const is_single_child_in_p = (node) => {
        return node.parentElement?.tagName === 'P' && node.parentElement.childNodes.length === 1;
      };
      const has_no_adjacent_non_empty_text_node = (node) => {
        const isPrevTextNodeEmpty =
          node.previousSibling?.nodeType === 3 && node.previousSibling.nodeValue.trim() === '';
        const isNextTextNodeEmpty =
          node.nextSibling?.nodeType === 3 && node.nextSibling.nodeValue.trim() === '';
        return (
          (node.previousSibling?.nodeType !== 3 || isPrevTextNodeEmpty) &&
          (node.nextSibling?.nodeType !== 3 || isNextTextNodeEmpty)
        );
      };
      const is_alone_or_adjacent_to_block = (node) => {
        const isNextSiblingBlock =
          !node.nextElementSibling ||
          !window.getComputedStyle(node.nextElementSibling).display.includes('inline') ||
          isImageContainer(node.nextElementSibling);
        const isPrevSiblingBlock =
          !node.previousElementSibling ||
          !window.getComputedStyle(node.previousElementSibling).display.includes('inline') ||
          isImageContainer(node.previousElementSibling);
        return (
          node.parentElement.childNodes.length === 1 || (isNextSiblingBlock && isPrevSiblingBlock)
        );
      };
      const is_block = (node) => {
        return (
          is_display_not_inline_and_float_none(node) ||
          is_section_with_prop(node) ||
          is_single_child_in_p(node) ||
          (node.parentElement &&
            is_display_not_inline_and_float_none(node.parentElement) &&
            has_no_adjacent_non_empty_text_node(node) &&
            is_alone_or_adjacent_to_block(node))
        );
      };
      return is_block(node);
    }

    // 寻找指定的祖先节点，找不到就返回父节点
    function findParentWithTag(node, tagName) {
      let current = node;
      while (current && current.nodeName !== 'SECTION') {
        if (current.nodeName === tagName) {
          return current;
        }
        current = current.parentElement;
      }
      return node.parentElement; // 当前节点的父节点
    }

    // 如果数组中的该项的祖先节点也存在于数组中时，则去除该项
    function filterByAncestors(domArray) {
      return domArray.filter((item, index) => {
        for (let i = 0; i < domArray.length; i++) {
          if (i !== index && domArray[i].contains(item)) {
            return false;
          }
        }
        return true;
      });
    }

    // 判断两个节点中间是否存在内容（判断高度）
    function isContinuous(node1, node2) {
      let range = new Range();
      range.setStartAfter(node1);
      range.setEndBefore(node2);
      // 检查Range内是否有高度
      const ele = range.cloneContents();
      // @tips: 直接 ele.textcontent = xxx，会把 ele 里的层级结构抹掉，存在丢失内容节点的风险，比如说 img 标签
      if (ele.textContent.trim().length) {
        return false;
      }
      for (const item of iterateNode([ele])) {
        if (!item.node?.children?.length) {
          // 最深的节点, 没有子节点
          item.node.textContent = item.node.textContent.trim();
        }
      }
      const div = document.createElement('div');
      div.appendChild(ele);
      document.body.appendChild(div);
      const height = div.offsetHeight;
      div.remove();
      return height === 0;
    }

    function findParentNode($node, callback) {
      if (!$node) {
        return null;
      }
      let $parentNode = $node.parentElement;
      while ($parentNode) {
        if (callback($parentNode)) {
          break;
        }
        $parentNode = $parentNode.parentElement;
      }
      return $parentNode;
    }

    function groupContinuousImages(nodes) {
      let groups = [];
      // 这里不能只存图片，还要考虑图说的情况
      let imagesAndTips = [];
      nodes.forEach((node) => {
        const imgArray = Array.from(node.querySelectorAll('img'))
          // 图片题、选项、 inline 图（小图）不能布局
          .filter(
            (v, index, arr) =>
              !findParentNode(v, (p) => Array.from(p.classList).some((v) => v.includes('choice')))
          )
          .filter((img) => !findParentNode(img, (e) => e?.dataset?._label === 'answer-block'))
          .filter(
            (img) =>
              isBlockImage(img) ||
              !img.offsetHeight * img.offsetWidth >
                8 * Math.pow(parseFloat(getComputedStyle(img).fontSize), 2)
          )
          .map((img) => {
            if (Array.from(img.parentElement?.classList).includes('img-signal-container')) {
              return img.parentElement;
            }
            return img;
          });
        imgArray.forEach(($img) => {
          const _$img = $img.tagName === 'IMG' ? $img : $img.querySelector('img'); // 这里是为了兼容 img-signal-container
          imagesAndTips.push($img);
          if (_$img?.dataset?.imageTip > 0) {
            const $imageTip = document.querySelector(
              `:not(img)[data-image-tip="${_$img.dataset.imageTip}"]`
            );
            if ($imageTip) {
              imagesAndTips.push($imageTip);
            }
          }
        });
      });
      // 如果图片填空的答案也是图片，可能会重复添加
      imagesAndTips = filterByAncestors(imagesAndTips);
      console.log(imagesAndTips);
      if (!imagesAndTips.length) return [];
      let currentGroup = [imagesAndTips[0]];
      console.log(currentGroup);
      for (let i = 0; i < imagesAndTips.length - 1; i++) {
        const img = imagesAndTips[i];
        const nextImg = imagesAndTips[i + 1];
        // 表格里的图片，注意不能跨行和跨标签
        // - 每个图片都必须检测是否是表格内图片，如果是，还需要判断是否在同一个 td ，否则直接重置 currentGroup
        // - 如果有一个图片是在表格内的，另一张图必须也在表格内，否则直接重置 currentGroup
        const tdContainer = findParentWithTag(img, 'TD');
        const nextTdContainer = findParentWithTag(nextImg, 'TD');
        if (
          (tdContainer?.tagName === 'TD' &&
            nextTdContainer?.tagName === 'TD' &&
            tdContainer !== nextTdContainer) ||
          (tdContainer?.tagName === 'TD' && nextTdContainer.tagName !== 'TD') ||
          (tdContainer?.tagName === 'TD' && nextTdContainer.tagName !== 'TD')
        ) {
          console.log(1);
          // 不能直接重置，因为里面可能有连续的图片了
          if (currentGroup.length > 1) {
            groups.push(currentGroup);
          }
          currentGroup = [];
        } else {
          if (!isContinuous(img, nextImg)) {
            if (currentGroup.length > 1) {
              groups.push(currentGroup);
            }
            groups.push(currentGroup);
            currentGroup = [];
          }
        }
        currentGroup.push(nextImg);
      }

      // 添加最后一个组（如果有）
      if (currentGroup.length > 0) {
        groups.push(currentGroup);
      }
      // 只需要保留图片节点或图片容器节点，过滤掉图说节点
      groups = groups.map((nodeArr) =>
        nodeArr.filter((node) => !(node.tagName !== 'IMG' && node.dataset.imageTip))
      );
      // 连续图片不管是否经过横向布局，都不再进行图文布局
      groups.forEach(($imgs) => {
        if ($imgs.length >= 2) {
          $imgs.forEach(($img) => {
            $img.setAttribute('can-i-layout', 'false');
          });
        }
      });
      return groups;
    }

    // 把图说移动到图片下方
    function moveImageTips(container) {
      console.log(container);
      const tips = container.querySelectorAll('span[data-image-tip]');
      for (let index = 0; index < tips.length; index++) {
        const tip = tips[index];
        const imgId = tip.getAttribute('data-image-tip');
        const img = document.querySelector(`img[data-image-tip="${imgId}"]`);
        if (!img) {
          continue;
        }
        tip.style.textAlign = 'center';
        if (
          img.parentElement?.classList.contains('img-signal-container') ||
          (img.parentElement?.tagName === 'P' && img.parentElement.childNodes.length === 1)
        ) {
          img.parentElement.after(tip);
        } else {
          img.after(tip);
        }
      }
    }
    // 判断节点是否为元素节点
    function isElement(node) {
      return node && node.nodeType === Node.ELEMENT_NODE;
    }
    // 判断节点主要的 prop
    function getRegionMainProp(node) {
      if (!node) {
        return '';
      }
      if (!isElement(node)) {
        return '';
      }
      const children = Array.from(node.querySelectorAll('[data-prop]'));
      // 有答案就是答案，有解析就是解析，有extra就是extra，有sn、source、body、choices就是body。
      const bodyProps = ['serial_number', 'source', 'body', 'choices'];
      if (children.some((c) => c.dataset.prop === 'answer')) {
        return 'answer';
      }
      if (children.some((c) => c.dataset.prop === 'analysis')) {
        return 'analysis';
      }
      if (children.some((c) => c.dataset.prop.includes('extra'))) {
        // 返回具体的 extra1 这种
        return children.find((c) => c.dataset.prop.includes('extra'))?.dataset.prop;
      }
      if (children.some((c) => bodyProps.includes(c.dataset.prop))) {
        return 'body';
      }
      return '';
    }

    // 获取相同 nodeId 和 prop 的节点
    function getNodeParts(element, nodeId, prop) {
      console.log(element);
      console.log(Array.from(element).querySelectorAll('section[data-region-id]'));

      return [...element.querySelectorAll('section[data-region-id]')]
        .filter((r) => r.dataset?.nodeId === nodeId)
        .filter((r) => getRegionMainProp(r) === prop && getBoundingClientRect(r).height !== 0);
    }

    function getRect(element, range = document.createRange()) {
      const { x, y, width, height } = getBoundingClientRect(element, range);
      if (!width) return;
      return { x, y, w: width, h: height, bottom: y + height, top: y };
    }

    /**
     * 查找一个满足条件的节点
     * @param {ArrayLike<T>|T[]|HTMLCollection} nodes 目标树
     * @param {IIterateNodePredictor<T>} predictor 条件回调
     * @param {IIterateNodeParams<T>} options 遍历参数
     * @return {T} 查找到的节点
     * @template T
     */
    function findNode(nodes, predictor, options = {}) {
      for (const item of iterateNode(nodes, options)) {
        if (predictor(item)) {
          return item.node;
        }
      }
    }

    /**
     * @param {Text|HTMLElement} element 目标元素
     * @param {Range} [range] Range 对象
     * @return {DOMRect} 位置大小对象
     */
    function getBoundingClientRect(element, range = document.createRange()) {
      try {
        if (element.getBoundingClientRect) {
          return element.getBoundingClientRect();
        }
        range.selectNode(element);
        return range.getBoundingClientRect();
      } catch (e) {
        return {};
      }
    }
    /**
     * 估算节点的行数
     * @param {*} node
     * @returns
     */
    const computeLineCount = (node) => {
      const content = findNode(
        [node],
        (item) => isElement(item.node) && !['DIV', 'SECTION'].includes(item.node.tagName)
      );
      if (!content) {
        return 1;
      }
      const rect = getRect(node);
      if (!rect) {
        return 1;
      }
      const { h } = rect;
      const { lineHeight } = window.getComputedStyle(content);
      return Math.round(Math.round(h) / Math.round(parseFloat(lineHeight)));
    };

    /**
     * 在同一个 SECTION 中找到下一个符合条件的兄弟元素
     * @param node
     * @param cb
     */
    function findNextSiblingElementInSection(node, cb = (next) => true) {
      let curNode = node;
      let nextSiblingElement = null;
      while (true) {
        if (!curNode) {
          break;
        }
        nextSiblingElement = curNode.nextElementSibling;
        curNode = curNode.parentElement;
        if (nextSiblingElement?.tagName === 'SECTION') {
          // 直接 break 掉
          nextSiblingElement = null;
          break;
        }
        if (!nextSiblingElement) {
          continue;
        }
        if (cb(nextSiblingElement)) {
          break;
        }
      }
      return nextSiblingElement;
    }

    /**
     * 判断节点是否是单行文本
     * @param {HTMLElement} element 元素
     */
    const checkSingleLine = (node) => {
      if (!['P', 'SECTION'].includes(node.tagName)) {
        return false;
      }
      return computeLineCount(node) === 1;
    };

    /**
     * 判定图说是否包含敏感信息
     * @returns boolean
     * @param node 假图说节点
     * @param img 图片节点
     */
    const checkImageTip = (node, img = null) => {
      const innerText = node.innerText.trim();
      if (!innerText || !checkSingleLine(node) || node.querySelector('img, table')) {
        return false;
      }
      //只有段落和图片之间没有其他内容时，才可以进行下一步判断
      const range = document.createRange();
      if (img) {
        range.setStartAfter(img);
        range.setEndBefore(node);
      }
      if (!img || !range.cloneContents()?.textContent?.trim()) {
        return (
          /blank/.test(innerText) || // 脏数据
          /^\s*$/.test(innerText) ||
          /^\s*（\d+）\s*$/.test(innerText) ||
          /第\s*\d+\s*题图/.test(innerText) ||
          /第\s*\d+\s*题/.test(innerText) ||
          /第\s*\d+\s*小题图/.test(innerText) ||
          /第\s*\d+\s*小题/.test(innerText) ||
          /（\d+）题图/.test(innerText) ||
          /第（\d+）题/.test(innerText) ||
          /\d+题/.test(innerText) ||
          /题\d+/.test(innerText) ||
          /图\s*[A-Z]?\s*\d+\.\d+[-−]\d+/.test(innerText) ||
          /图\s*\d+[-−]\d+\.\d+[-−]\d+/.test(innerText) ||
          /图\s*\d+[-−][A-Z][-−]\d+/.test(innerText) ||
          /图\s*\d+\.\d+\.\d+[-−]\d+/.test(innerText) ||
          /图\s*[A-Z]+\s*\d+\.\d+\.\d+[-−]\d+/.test(innerText) ||
          /图\s*\d+[-−]\d+/.test(innerText) ||
          /图\s*\d+[-−]\d+[-−]\d+/.test(innerText) ||
          /图\s*[A-Z]+\d*[-−]\d+[-−]\d+/.test(innerText) ||
          /图\s*[A-Z][-−]\d+[-−]\d+[-−]\d+/.test(innerText) ||
          /图\s*[A-Z][-−]\d+/.test(innerText) ||
          /图\s*[A-Z]\d+[-−]/.test(innerText) ||
          /图\s*[A-Z]\s*\d+/.test(innerText) ||
          /图\s*[A-Z]+\s*\d*[-−]\d+/.test(innerText) ||
          /图\s*[A-Z]\s*\d+\.\d+[-−]\d+/.test(innerText) ||
          /图\s*[A-Z]\d+\.\d+[-−]\d+（\d+）/.test(innerText) ||
          /图\s*\d+\s*[-−]\s*\d+\s*[A-Z]\s*[-−]\s*\d+/.test(innerText) ||
          /图\s*[A-Z]\s*\d+\s*[-−]\s*\d+\s*[A-Z]\s*[-−]\s*\d+/.test(innerText) ||
          /图\s*[-−]\d+/.test(innerText) ||
          /^\s*[A-Z]\d+[-−]\d+/.test(innerText) ||
          /^\s*图\d+/.test(innerText) ||
          /^\s*图（\d+）/.test(innerText) ||
          /^\s*图（[a-z]）/.test(innerText) ||
          /题图/.test(innerText) ||
          /答图/.test(innerText) ||
          /答案图/.test(innerText) ||
          /解图/.test(innerText) ||
          /备用图/.test(innerText) ||
          /训练图/.test(innerText) ||
          /例题图/.test(innerText) ||
          /分析图/.test(innerText) ||
          /典例图/.test(innerText) ||
          /^\s*选项\s*$/.test(innerText) ||
          /^\s*图\s*$/.test(innerText) ||
          /^\s*（\d+\s*$/.test(innerText) ||
          /（\d+）图/.test(innerText)
        );
      }
      return false;
    };

    /**
     * 截取节点
     * @param childNode 子节点
     * @param templateNode 生成节点的模板
     * @param {'up' | 'down' } type 截取上方的还是下方
     */
    function generateRegion(childNode, templateNode, type) {
      if (!templateNode.parentElement) {
        return null;
      }
      if (!childNode && type === 'up') {
        const rangeUp = document.createRange();
        rangeUp.setStartBefore(templateNode);
        rangeUp.setEndAfter(templateNode);
        return rangeUp.cloneContents();
      }
      if (!childNode && type === 'down') {
        const rangeDown = document.createRange();
        rangeDown.setStartBefore(templateNode);
        rangeDown.setEndAfter(templateNode);
        return rangeDown.cloneContents();
      }
      if (!type || type === 'up') {
        const rangeUp = document.createRange();
        rangeUp.setStartBefore(templateNode);
        rangeUp.setEndBefore(childNode);
        return rangeUp.cloneContents();
      }
      const rangeDown = document.createRange();
      rangeDown.setStartAfter(childNode);
      rangeDown.setEndAfter(templateNode);
      return rangeDown.cloneContents();
    }

    // 拆 region
    function splitDom($imgs) {
      const _getImgId = (element) => {
        let imgId = element.getAttribute('img-id');
        if (!imgId) {
          // 如果没有 img-id, 则可能是图说，根据 image-tip 找到对应的图片，再去找 img-id
          const imageTip = element.dataset.imageTip;
          const imgElement = document.querySelector(`img[data-image-tip="${imageTip}"]`);
          imgId = imgElement?.getAttribute('img-id');
        }
        if (element.tagName !== 'IMG' && !element.dataset.imageTip) {
          // 如果元素不是 IMG 且没有 image-tip，支持 img-signal-container
          const _$img = element.querySelector('img');
          imgId = _$img?.getAttribute('img-id');
        }
        return imgId;
      };

      const _findImageParentInTd = (img) => {
        let $parent = findParentNode(img, (p) => p.parentElement?.tagName === 'TD');
        if (!$parent) {
          const td = findParentWithTag(img, 'TD');
          const children = Array.from(td.children);
          const div = document.createElement('div');
          td.appendChild(div);
          div.append(...children);
          $parent = div;
        }
        return $parent;
      };

      const _find$imgtip = (node) => {
        let $imgTip = null;
        const $img = node.querySelector('img') || node; // 图片填空的情况要兼容一下
        if ($img.dataset?.imageTip) {
          $imgTip = document.querySelector(`:not(img)[data-image-tip="${$img.dataset.imageTip}"]`);
        }
        // @tips: 图片下方可能存在类似图说的段落，也需要加进来。
        let next$p = findNextSiblingElementInSection(node, (next) => next.tagName === 'P');
        // 也可能是一个文字节点
        if (
          !next$p &&
          $img.nextSibling?.nodeType === Element.TEXT_NODE &&
          $img.parentElement.childNodes.length === 2
        ) {
          const $next = document.createElement('p');
          $next.textContent = $img.nextSibling.textContent;
          $img.nextSibling.replaceWith($next);
          next$p = $next;
        }
        if (next$p && checkImageTip(next$p, $img) && !$imgTip) {
          next$p.setAttribute('data-fake-image-tip', 1);
          next$p.classList.add('align-center');
          $imgTip = next$p;
        }
        return $imgTip;
      };

      const $div = document.createElement('div'); // div 里的图片都是连续的
      let last$img = $imgs[$imgs.length - 1]; // 连续图片+图说里的最后一个结点
      let first$img = $imgs[0]; // 连续图片里的第一个图片
      // 获取 lastimgid 和 firstimgid
      let firstimgid = _getImgId(first$img);
      let lastimgid = _getImgId(last$img);

      const isTdImage = findParentWithTag(first$img, 'TD')?.tagName === 'TD'; // 在单元格里的连续图片会有点不一样
      let $parent1 = findParentWithTag(first$img, 'P');
      let $parent2 = findParentWithTag(last$img, 'P');
      if (isTdImage) {
        // 单元格、里找到 TD 节点的下一级
        $parent1 = _findImageParentInTd(first$img);
        $parent2 = _findImageParentInTd(last$img);
      }
      let $nodeup = generateRegion(first$img, $parent1, 'up');
      let $prev = first$img.previousElementSibling;
      let $parent = first$img;
      while (!$prev) {
        // 单元格：  if ($parent.dataset?.regionId) break;
        if (isTdImage && $parent.tagName === 'TD') break;
        $prev = $parent.previousElementSibling;
        $parent = $parent.parentElement;
      }
      let $nodedown = generateRegion($prev, $parent1, 'down');

      if (!!$prev) {
        // 若上面可以正常拆的话...
        $parent1.after($nodedown);
        $parent1.after($nodeup);
        $nodeup = $parent1.nextElementSibling;
        $nodedown = $nodeup.nextElementSibling;
        $parent1.remove();
        // @tips：这里需要重新找一下，避免 dom 在上面的流程被删掉过。
        if (last$img.tagName === 'IMG') {
          // 图片
          last$img = document.querySelector(`[img-id="${lastimgid}"]`);
        } else if (last$img.getAttribute('data-image-tip')) {
          // 图说
          last$img = document.querySelector(
            `:not(img)[data-image-tip="${last$img.dataset.imageTip}"]`
          );
        } else {
          // 图片填空
          const _$img = document.querySelector(`[img-id="${lastimgid}"]`);
          last$img = _$img.parentElement; // 姑且往上找一层看看
        }
        if (isTdImage) {
          $parent2 = _findImageParentInTd(last$img);
        } else {
          console.log(last$img);

          $parent2 = findParentWithTag(last$img, 'P');
        }
      }
      const last$imgtip = _find$imgtip(last$img);
      const last$node = last$imgtip || last$img;
      let $next = last$node.nextElementSibling;
      $parent = last$node;
      while (!$next) {
        // if ($parent.dataset?.regionId) break;
        if (isTdImage && $parent.tagName === 'TD') break;
        $next = $parent.nextElementSibling;
        $parent = $parent.parentElement;
      }
      if (!!$next) {
        // 若下面可以正常拆的话...
        $nodeup = generateRegion($next, $parent2, 'up');
        $nodedown = generateRegion(last$node, $parent2, 'down');
        $parent2.after($nodedown);
        $parent2.after($nodeup);
        $nodeup = $parent2.nextElementSibling;
        $nodedown = $nodeup.nextElementSibling;
        $parent2.remove();
      }
      if (!$next && !$prev) {
        return { type: isTdImage ? 'td' : 'normal', element: null };
      }
      $imgs = $imgs.map((img) => {
        let _$img = img.tagName === 'IMG' ? img : img.querySelector('img');
        _$img = document.querySelector(`img[img-id="${_$img.getAttribute('img-id')}"]`);
        if (img.tagName === 'IMG') return _$img;
        return _$img.parentElement;
      });
      const $imgsAndImgTips = [];
      $imgs.forEach((node) => {
        // 收集一下全部图片+图说节点
        $imgsAndImgTips.push(node);
        const $imgTip = _find$imgtip(node);
        if ($imgTip) $imgsAndImgTips.push($imgTip);
      });
      // @description 处理表格单元格内的图片
      function _processTdImages() {
        if (first$img.tagName === 'IMG') {
          // 图片
          first$img = document.querySelector(`[img-id="${firstimgid}"]`);
        } else if (first$img.getAttribute('data-image-tip')) {
          // 图说
          first$img = document.querySelector(
            `:not(img)[data-image-tip="${first$img.dataset.imageTip}"]`
          );
        } else {
          // 图片填空
          const _$img = document.querySelector(`[img-id="${firstimgid}"]`);
          first$img = _$img.parentElement; // 姑且往上找一层看看
        }
        first$img.before($div);
        $div.append(...$imgsAndImgTips);
      }
      // @description 处理普通的流式图片
      function _processNormalImages() {
        let img$section = first$img;
        let $parent = first$img.parentElement;
        let $regions = Array.from(new Set($imgs.map((img) => findParentWithTag(img, 'P'))));
        $regions = $regions.filter((r) => !!r);
        $div.append(...$imgsAndImgTips); // 把全部图片+图说放到一个 div 里
        while (img$section.tagName !== 'P') {
          const $clone = $parent.cloneNode(false);
          if (img$section === first$img) {
            $clone.appendChild($div); // 给这个新的 div 创建一个 region 出来
          } else {
            $clone.appendChild(img$section);
          }
          img$section = $clone;
          $parent = $parent.parentElement;
        }
        $regions[$regions.length - 1].after(img$section);
        $regions.forEach((r) => {
          // 如果 region 里还有内容，不要直接移除，只移除空标签
          if (!r.textContent.trim() && !r.querySelector('img')) {
            r.remove();
          } else {
            img$section.after(r);
          }
        });
      }
      if (isTdImage) {
        _processTdImages();
      } else {
        _processNormalImages();
      }
      return { type: isTdImage ? 'td' : 'normal', element: $div };
    }
    /**
     *
     * @param {*} container
     */
    // function moveImageTips(container) {
    //   // ***************************
    //   // 把图说移动到图片下方
    //   // ***************************
    //   const tips = container.querySelectorAll('span[data-image-tip]');
    //   for (let index = 0; index < tips.length; index++) {
    //     const tip = tips[index];
    //     const imgId = tip.getAttribute('data-image-tip');
    //     const img = document.querySelector(`img[data-image-tip="${imgId}"]`);
    //     if (!img) {
    //       continue;
    //     }
    //     tip.style.textAlign = 'center';
    //     if (
    //       img.parentElement?.classList.contains('img-signal-container') ||
    //       (img.parentElement?.tagName === 'P' && img.parentElement.childNodes.length === 1)
    //     ) {
    //       img.parentElement.after(tip);
    //     } else {
    //       img.after(tip);
    //     }
    //   }
    // }
    /**
     *  计算图片的高度（包含图说）
     * @param node
     * @param $parent
     * @return {number|*}
     */
    function getImageAndImageTipHeight(node) {
      if (!node) return 0;
      // 可能传入的是一个图片的容器节点
      const _$img = node.tagName === 'IMG' ? node : node.querySelector('img');
      if (_$img.dataset.imageTip) {
        // 查找非IMG标签的图说
        const description = document.querySelector(
          `:not(img)[data-image-tip="${_$img.dataset.imageTip}"]`
        );
        return _$img.offsetHeight + (description ? description.offsetHeight : 0);
      } else {
        return _$img.offsetHeight;
      }
    }
    /**
     *  计算图片面积
     * @param $img
     * @param $parent
     * @return {number|*}
     */
    function getImageArea($img) {
      return $img.offsetHeight * $img.offsetWidth;
    }

    // 把多张图片自动转化为单行布局
    function layoutImages(element, params) {
      console.log(element);

      // 1. 圈选连续图片
      // 2. 把适合放在一起布局的图片分组
      // 3. 把每组图片放进一个布局容器里
      // 4. 删掉高度为0的空dom节点
      // 5. 调整图片尺寸
      const layoutNodes = []; // 包含图片的元素
      // 1. region
      // 存放已经处理过的 regions, key 是 node_id#prop
      const regionProcessMap = {};
      const allRegion = Array.from(document.querySelectorAll('[data-region-id]'));
      console.log(allRegion);

      allRegion.forEach((item) => {
        // 这里会得到两个相同的 region，相同的节点需要去重
        const regionProp = getRegionMainProp(item);
        const regions = getNodeParts(element, item.dataset.nodeId, regionProp);
        // 若处理过，直接 return
        if (regionProcessMap[`${item.dataset.nodeId}#${regionProp}`]) {
          return;
        }
        regionProcessMap[`${item.dataset.nodeId}#${regionProp}`] = true;
        // 2. 寻找连续的图片
        // 找到最深的后代节点
        // 找到连续的图片，遍历数组，若节点有高度、并且是 IMG、并且 index 连续，则认为是连续的,
        // 若节点有 data-image-tip，则忽略。
        const groupBycontinuous = groupContinuousImages(regions); // 连续图片数组的数组
        groupBycontinuous?.forEach((imgs) => {
          if (imgs.length < 2) {
            return;
          }
          // @tips：在 splitDom 后上面读取的 img 节点会丢失，重新找一下。
          if (imgs.some((img) => img.offsetHeight <= 0)) {
            const imgIds = imgs.map((img) => img.getAttribute('img-id'));
            imgs = imgIds.map((imgId) => document.querySelector(`img[img-id="${imgId}"]`)); // @todo：这里可以通过找上一个 dom 节点来优化复杂度
          }
          // 根据高度再分组，@todo：是不是放到 groupContinuousImages 里更好？
          const groupByHeight = [];
          imgs.forEach(($img, index) => {
            if (index === 0) {
              groupByHeight[0] = [$img];
            } else {
              const $lastImg = imgs[index - 1];
              // 1. 高度判断
              // 2. 面积判断
              if (
                getImageAndImageTipHeight($img) >= getImageAndImageTipHeight($lastImg) * 4 ||
                getImageAndImageTipHeight($img) < getImageAndImageTipHeight($lastImg) / 4 ||
                getImageArea($img) > getImageArea($lastImg) * 6 ||
                getImageArea($img) <= getImageArea($lastImg) / 6
              ) {
                groupByHeight[groupByHeight.length] = [$img];
              } else {
                groupByHeight[groupByHeight.length - 1].push($img);
              }
            }
          });
          groupByHeight.forEach(($imgs) => {
            // @tips：若一组只有一个图片，那就不布局。
            if ($imgs.length < 2) {
              return;
            }
            // @tips：在 splitDom 后上面读取的 img 节点会丢失，重新找一下。
            if ($imgs.some((img) => img.offsetHeight <= 0)) {
              const imgIds = imgs.map((img) => {
                if (img.tagName === 'IMG') return img.getAttribute('img-id');
                return img.querySelector('img').getAttribute('img-id');
              });
              $imgs = imgIds.map((imgId, i) => {
                const _$img = document.querySelector(`img[img-id="${imgId}"]`);
                if (imgs[i].tagName === 'IMG') return _$img;
                return _$img.parentElement;
              }); // @todo：这里可以通过找上一个 dom 节点来优化复杂度
            }
            const { element, type } = splitDom($imgs);
            if (element?.children.length) layoutNodes.push({ element, type });
          });
        });
      });
      console.log(layoutNodes);

      // 开始重新布局
      layoutNodes.forEach((node) => {
        const { element: _node, type } = node;
        // 判断两张图是否连续（不包含图说）
        // - 这儿已经分好组了，可以直接找当前节点下的连续图片
        // - 查找图片的时候需要注意：图片填空需要找到它的容器进行布局，而不是图片
        let contentArray = [
          // 1. 图片填空容器
          // 2. 图片
          // 3. 类似图说的段落
          Array.from(
            _node.querySelectorAll('.img-signal-container, img, [data-fake-image-tip]')
          ).filter((v) => !(v.tagName === 'IMG' && v.closest('.img-signal-container')))
        ];
        contentArray = contentArray.filter((v) => v.length >= 2);
        // 有两张以上连续图片（不包含图说）
        for (let i = 0; i < contentArray.length; i++) {
          const contentItem = contentArray[i];
          // 之前的做法是重新创建 div，现在的 $div 可以直接用
          const container = document.createElement('div');
          container.className = 'layout-img-line layout-container flex-container';
          // 向上找到 section
          // 如果是表格里的图片，就找父节点 td
          let sectionNode = findParentNode(contentItem[0], (p) => p.tagName === 'SECTION');
          if (type === 'td' || !sectionNode) {
            contentItem[0].parentElement.before(container);
          } else {
            sectionNode.appendChild(container);
          }
          for (let j = 0; j < contentItem.length; j++) {
            const img = contentItem[j];
            const imgsContainer = document.createElement('div');
            // 布局后会改变容器宽度（100%），如果是图片填空的话，定位会有问题，所以这里需要固定图片的宽度
            img.style.width = img.offsetWidth + 'px';
            if (
              img.nextElementSibling &&
              img.nextElementSibling.getAttribute('data-image-tip') &&
              img.nextElementSibling.nodeName !== 'IMG'
            ) {
              img.nextElementSibling.style.textAlign = 'center';
              imgsContainer.appendChild(img.nextElementSibling);
            }
            img.setAttribute('data-img-align', 'center');
            img.style.display = 'block';
            img.setAttribute('data-display', 'block');
            imgsContainer.prepend(img);
            container.appendChild(imgsContainer);
          }
          // 布局完成后，清除多余的空节点 ( div )
          sectionNode && clearEmptyDomnode(sectionNode);
          _node.remove();
        }
      });
      // @tips：布局后的一些处理
      // - 图片尺寸的缩放
      // - 图片横向布局容器的拆开
      const containers = document.querySelectorAll('.layout-img-line');
      // - 若图片的个数小于等于4个，则尽量一行布局（@todo：这里再精细一些、需要考虑图片不要压缩得太小
      containers.forEach((container) => {
        let step = 0.95;
        let count = 7;
        if (params.stage === 'generatePptxFromHtml' || params.taskType === 'json2ppt') {
          count = 17;
        }
        const $imgs = container.querySelectorAll('img');
        [...$imgs].forEach((img) => {
          img.setAttribute('data-before-layout-height', img.offsetHeight);
          img.setAttribute('data-before-layout-width', img.offsetWidth);
        });
        while (
          $imgs.length <= 4 &&
          count > 0 &&
          Array.from(
            new Set( // 对齐底部，故而这里取 bottom 值来判定行数
              [...container.children]
                .map((item) => parseInt(getRect(item.querySelector('img'))?.bottom ?? -1))
                .filter((b) => b > 0)
            )
          ).length > 1
        ) {
          [...$imgs].forEach((img) => {
            const width = img.offsetWidth;
            const height = img.offsetHeight;
            img.style.width = `${width * step}px`;
            img.style.height = `${height * step}px`;
            if (img.nextElementSibling?.dataset?.imageTip)
              img.nextElementSibling.style.width = `${width * step}px`;
          });
          count--;
        }
        if (count <= 0) {
          // 还原图片尺寸
          [...$imgs].forEach((img) => {
            img.style.width = `${img.dataset.beforeLayoutWidth}px`;
            img.style.height = `${img.dataset.beforeLayoutHeight}px`;
          });
        }
      });
      // 尽量不要有单独成行的图片
      containers.forEach((container) => {
        const containerWidth = container.offsetWidth;
        const $imgs = Array.from(container.querySelectorAll('img'));
        // 记录当前宽高
        $imgs.forEach(($img) => {
          $img.setAttribute('data-before-layout-width', $img.offsetWidth);
          $img.setAttribute('data-before-layout-height', $img.offsetHeight);
        });
        // 额外的宽度：图片的div有 padding, 图片本身带 margin
        let extraWidth = 2 + 2 + 10 + 10;
        // 计算最后一行有几个图片
        let perRowImgCounts = countChildrenPerRow(
          containerWidth,
          $imgs.map(($img) => $img.offsetWidth + extraWidth)
        );
        const step = 0.95;
        // 调整图片的宽高，直到最后一行的个数不为1
        while (perRowImgCounts[perRowImgCounts.length - 1] === 1 && $imgs.length > 1) {
          $imgs.forEach(($img) => {
            const width = $img.offsetWidth;
            const height = $img.offsetHeight;
            $img.style.width = `${width * step}px`;
            $img.style.height = `${height * step}px`;
          });
          const widthArr = $imgs.map(($img) => parseFloat($img.style.width) + extraWidth);
          perRowImgCounts = countChildrenPerRow(containerWidth, widthArr);
        }
        // 如果第一张图片的大小小于原来的 70%，就不缩图了
        if (parseFloat($imgs[0].style.width) / $imgs[0].dataset.beforeLayoutWidth < 0.7) {
          $imgs.forEach(($img) => {
            $img.style.width = $img.dataset.beforeLayoutWidth + 'px';
            $img.style.height = $img.dataset.beforeLayoutHeight + 'px';
          });
        }
      });
      // 把没有进行布局的容器拆开
      containers.forEach((container) => {
        const containerHeight = parseInt(getRect(container).h);
        let contentHeight = 0;
        [...container.children].forEach((div) => {
          contentHeight += getRect(div).h;
        });
        contentHeight = parseInt(contentHeight);
        if (contentHeight === containerHeight) {
          [...container.children].forEach((div) => {
            container.before(div);
          });
          container.remove();
        }
      });
      // 移动图说
      // moveImageTips(element);
      // 若容器外部有 span 标签，则把容器拆出来
      containers.forEach((container) => {
        const parent = findParentNode(container, (p) => ['SPAN', 'B'].includes(p.tagName));
        if (parent) {
          parent.outerHTML = parent.outerHTML.replace('span', 'div');
        }
      });
    }

    // const nodes = [];
    // p = document.createElement('p');
    // img11 = document.createElement('img');
    // img11.style.width = '100px';
    // img11.style.height = '100px';
    // img11.style.backgroundColor = 'pink';
    // img11.dataset.imgId = '1';
    // img11.setAttribute('img-id', '1');
    // p.insertBefore(img11, p.firstChild);

    // p2 = document.createElement('p');
    // img22 = document.createElement('img');
    // img22.style.width = '100px';
    // img22.style.height = '100px';
    // img22.style.backgroundColor = 'red';
    // img22.setAttribute('img-id', '2');
    // p2.insertBefore(img22, p2.firstChild);

    // p3 = document.createElement('p');
    // span = document.createElement('span');
    // span.innerText = '123';
    // p3.insertBefore(span, p3.firstChild);

    // p4 = document.createElement('p');
    // img2 = document.createElement('img');
    // img2.style.width = '100px';
    // img2.style.height = '100px';
    // img2.style.backgroundColor = 'green';
    // img2.setAttribute('img-id', '3');
    // p4.insertBefore(img2, p4.firstChild);

    // nodes.push(p);
    // nodes.push(p2);
    // nodes.push(p3);
    // nodes.push(p4);
    // console.log(nodes);

    // document.body.appendChild(p);
    // document.body.appendChild(p2);
    // document.body.appendChild(p3);
    // document.body.appendChild(p4);

    const nodes = document.querySelectorAll('p');
    console.log(nodes);

    const groupBycontinuous = groupContinuousImages(Array.from(nodes)); // 连续图片数组的数组
    console.log(groupBycontinuous);
    groupBycontinuous?.forEach((imgs) => {
      if (imgs.length < 2) {
        return;
      }
      // @tips：在 splitDom 后上面读取的 img 节点会丢失，重新找一下。
      if (imgs.some((img) => img.offsetHeight <= 0)) {
        const imgIds = imgs.map((img) => img.getAttribute('img-id'));
        imgs = imgIds.map((imgId) => document.querySelector(`img[img-id="${imgId}"]`)); // @todo：这里可以通过找上一个 dom 节点来优化复杂度
      }
      // 根据高度再分组，@todo：是不是放到 groupContinuousImages 里更好？
      const groupByHeight = [];
      imgs.forEach(($img, index) => {
        if (index === 0) {
          groupByHeight[0] = [$img];
        } else {
          const $lastImg = imgs[index - 1];
          // 1. 高度判断
          // 2. 面积判断
          if (
            getImageAndImageTipHeight($img) >= getImageAndImageTipHeight($lastImg) * 4 ||
            getImageAndImageTipHeight($img) < getImageAndImageTipHeight($lastImg) / 4 ||
            getImageArea($img) > getImageArea($lastImg) * 6 ||
            getImageArea($img) <= getImageArea($lastImg) / 6
          ) {
            groupByHeight[groupByHeight.length] = [$img];
          } else {
            groupByHeight[groupByHeight.length - 1].push($img);
          }
        }
      });

      groupByHeight.forEach(($imgs) => {
        // @tips：若一组只有一个图片，那就不布局。
        if ($imgs.length < 2) {
          return;
        }
        // @tips：在 splitDom 后上面读取的 img 节点会丢失，重新找一下。
        if ($imgs.some((img) => img.offsetHeight <= 0)) {
          const imgIds = imgs.map((img) => {
            if (img.tagName === 'IMG') return img.getAttribute('img-id');
            return img.querySelector('img').getAttribute('img-id');
          });
          $imgs = imgIds.map((imgId, i) => {
            const _$img = document.querySelector(`img[img-id="${imgId}"]`);
            if (imgs[i].tagName === 'IMG') return _$img;
            return _$img.parentElement;
          }); // @todo：这里可以通过找上一个 dom 节点来优化复杂度
        }
        const { element, type } = splitDom($imgs);
        console.log(element);
        console.log(type);

        // if (element?.children.length) layoutNodes.push({ element, type });
      });
    });
  </script>
</html>
